declare -Ag leader_key_map
leader_key() { key_map=leader_key_map ; }

. $FTL_CFG/etc/extra_commands/compress
. $FTL_CFG/etc/extra_commands/optimize

leader_key_map[f]=leader_ftl
leader_ftl() { key_map=super_leader_ftl ; }
super_leader_ftl()
{
case "$REPLY" in
	c  ) compress ;;
	i  ) image_optimize ;;
	m  ) mutt $([[ ${#selection[@]} ]] && printf "\055a %s\n" "${selection[@]}" || [[ $f ]] && echo "-a $f") -s 'ftl files' -- ; refresh ; list ;;
	p  ) [[ $e == pdf ]] && pdf_optimize ;;
	P  ) [[ $e == pdf ]] && [[ ! -e "$f.txt" ]] && { mutool draw -o "$f.txt" "$f" 2>/dev/null ; cdir '' "$f.txt" ; } ;;
	s  ) tcpreview
	     tsplit "{ stat '$n' ; echo '  mime: $mtype' ; echo -n '  type: ' ; file -b ${n@Q} ;} | piper --global '\w+: ' 'blue' '\d+\ ?x\ ?\d+' 'yellow' ; read -sn1" ;;
	t  ) shell_pop  ;;
	v  ) [[ $e == mp4 ]] && video_optimize ;;
	x  ) [[ $e =~ gpg ]] && tmux popup -h90% -w90% "gpg -d $n" || gpg -e -u "$GPGID" -r "$(gpg -K | grep uid | cut -d' ' -f 13- | fzf)" "$f" || read -sn1 ; cdir '' "$f.gpg" ;;
	z  ) [[ $e =~ gpg ]] && prompt 'file: ' -e && [[ -n "$REPLY" ]] && gpg -d "$n" > "$REPLY" || gpg --output "$f.gpg" --symmetric "$f" || read -sn1 ; cdir '' "$REPLY" ;;

	*  ) ftl_help ;;
esac

key_map=ftl_key_map
}

bind ftl extra	˽fP	pdf2txt			"convert current pdf to text file"
bind ftl extra	˽fc	compress		"compress/decompress"
bind ftl extra	˽fi	optimize_image		"reduce jpg image size, converts png to jpg"
bind ftl extra	˽fm	mutt			"send selection in mail"
bind ftl extra	˽fp	optimize_pdf		"reduce pdf size"
bind ftl extra	˽fs	stat_file		"display stat information for file in preview pane"
bind ftl extra	˽ft	shell_pop		"terminal popup"
bind ftl extra	˽fv	optimize_video		"reduce video size"
bind ftl extra	˽fx	gpg_encrypt		"GPG encrypt/decrypt"
bind ftl extra	˽fz	password_encrypt	"password encrypt/decrypt"

# vim: set filetype=bash :
